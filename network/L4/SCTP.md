**SCTP** ([англ.](https://ru.wikipedia.org/wiki/%D0%90%D0%BD%D0%B3%D0%BB%D0%B8%D0%B9%D1%81%D0%BA%D0%B8%D0%B9_%D1%8F%D0%B7%D1%8B%D0%BA "Английский язык") Stream Control Transmission Protocol — «протокол передачи с управлением потоком») — [протокол](https://ru.wikipedia.org/wiki/%D0%A1%D0%B5%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D0%BF%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB "Сетевой протокол") [транспортного уровня](https://ru.wikipedia.org/wiki/%D0%A2%D1%80%D0%B0%D0%BD%D1%81%D0%BF%D0%BE%D1%80%D1%82%D0%BD%D1%8B%D0%B9_%D1%83%D1%80%D0%BE%D0%B2%D0%B5%D0%BD%D1%8C "Транспортный уровень") в [компьютерных сетях](https://ru.wikipedia.org/wiki/%D0%9A%D0%BE%D0%BC%D0%BF%D1%8C%D1%8E%D1%82%D0%B5%D1%80%D0%BD%D1%8B%D0%B5_%D1%81%D0%B5%D1%82%D0%B8 "Компьютерные сети"), появившийся в 2000 году в [IETF](https://ru.wikipedia.org/wiki/IETF "IETF"). [RFC 4960](https://tools.ietf.org/html/rfc4960) описывает этот протокол, а [RFC 3286](https://tools.ietf.org/html/rfc3286) содержит техническое вступление к нему.

Как и любой другой протокол передачи данных транспортного уровня, SCTP работает аналогично [TCP](https://ru.wikipedia.org/wiki/TCP "TCP") или [UDP](https://ru.wikipedia.org/wiki/UDP "UDP")[[1]](https://ru.wikipedia.org/wiki/SCTP#cite_note-1). Будучи более новым протоколом, SCTP имеет несколько нововведений, таких как многопоточность, защита от DDoS-атак, синхронное соединение между двумя хостами по двум и более независимым физическим каналам (multi-homing).
#### Безопасное установление соединения

Создание нового подключения в протоколах TCP и SCTP происходит при помощи механизма подтверждения (квитирования) пакетов. В протоколе TCP данная процедура получила название трёхэтапное рукопожатие (three-way handshake). Клиент посылает пакет SYN (сокр. Synchronize). Сервер отвечает пакетом SYN-ACK (Synchronize-Acknowledge). Клиент подтверждает приём пакета SYN-ACK пакетом ACK. На этом процедура установления соединения завершается.

Протокол TCP имеет потенциальную уязвимость, обусловленную тем, что нарушитель, устанавливая фальшивые IP-адреса отправителя, может послать серверу множество пакетов SYN. При получении пакета SYN сервер выделяет часть своих ресурсов для установления нового соединения. Обработка множества пакетов SYN рано или поздно затребует все ресурсы сервера и сделает невозможной обработку новых запросов. Такой вид атак называется «[SYN-флуд](https://ru.wikipedia.org/wiki/SYN-%D1%84%D0%BB%D1%83%D0%B4 "SYN-флуд")» (SYN flood).

Протокол SCTP защищён от подобных атак с помощью механизма четырёхэтапного квитирования (four-way handshake) и вводом маркера (cookie). По протоколу SCTP клиент начинает процедуру установления соединения, посылая пакет INIT. В ответ сервер посылает пакет INIT-ACK, который содержит маркер (уникальный ключ, идентифицирующий новое соединение). Затем клиент отвечает посылкой пакета COOKIE-ECHO, в котором содержится маркер, полученный от сервера. Только после этого сервер выделяет свои ресурсы новому подключению и подтверждает это отправкой клиенту пакета COOKIE-ACK.

#### Безопасное установление соединения

Создание нового подключения в протоколах TCP и SCTP происходит при помощи механизма подтверждения (квитирования) пакетов. В протоколе TCP данная процедура получила название трёхэтапное рукопожатие (three-way handshake). Клиент посылает пакет SYN (сокр. Synchronize). Сервер отвечает пакетом SYN-ACK (Synchronize-Acknowledge). Клиент подтверждает приём пакета SYN-ACK пакетом ACK. На этом процедура установления соединения завершается.

Протокол TCP имеет потенциальную уязвимость, обусловленную тем, что нарушитель, устанавливая фальшивые IP-адреса отправителя, может послать серверу множество пакетов SYN. При получении пакета SYN сервер выделяет часть своих ресурсов для установления нового соединения. Обработка множества пакетов SYN рано или поздно затребует все ресурсы сервера и сделает невозможной обработку новых запросов. Такой вид атак называется «[SYN-флуд](https://ru.wikipedia.org/wiki/SYN-%D1%84%D0%BB%D1%83%D0%B4 "SYN-флуд")» (SYN flood).

Протокол SCTP защищён от подобных атак с помощью механизма четырёхэтапного квитирования (four-way handshake) и вводом маркера (cookie). По протоколу SCTP клиент начинает процедуру установления соединения, посылая пакет INIT. В ответ сервер посылает пакет INIT-ACK, который содержит маркер (уникальный ключ, идентифицирующий новое соединение). Затем клиент отвечает посылкой пакета COOKIE-ECHO, в котором содержится маркер, полученный от сервера. Только после этого сервер выделяет свои ресурсы новому подключению и подтверждает это отправкой клиенту пакета COOKIE-ACK.

## Многопоточность

[TCP](https://ru.wikipedia.org/wiki/TCP "TCP") управляет [последовательностью](https://ru.wikipedia.org/wiki/%D0%9F%D0%BE%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%8C "Последовательность") [байт](https://ru.wikipedia.org/wiki/%D0%91%D0%B0%D0%B9%D1%82 "Байт"): данные, посланные приложением-отправителем, должны поступать приложению-получателю строго в том же порядке (в то время как протокол IP способен поменять последовательность пакетов; кроме того, пропавшие пакеты посылаются повторно и обычно прибывают к получателю с нарушением последовательности; для борьбы с этими явлениями данные накапливаются в буфере). SCTP может транспортировать [данные](https://ru.wikipedia.org/wiki/%D0%94%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5 "Данные") между двумя [точками](https://ru.wikipedia.org/wiki/%D0%A2%D0%BE%D1%87%D0%BA%D0%B0 "Точка") ([узлами](https://ru.wikipedia.org/wiki/%D0%A3%D0%B7%D0%B5%D0%BB_%D1%81%D0%B5%D1%82%D0%B8 "Узел сети")) одновременно по нескольким [потокам](https://ru.wikipedia.org/wiki/%D0%91%D0%B8%D1%82%D0%BE%D0%B2%D1%8B%D0%B9_%D0%BF%D0%BE%D1%82%D0%BE%D0%BA "Битовый поток") _сообщений_. В противоположность к [TCP](https://ru.wikipedia.org/wiki/TCP "TCP"), SCTP обрабатывает целые _сообщения_ (preserve message boundary), а не обычные байты [информации](https://ru.wikipedia.org/wiki/%D0%98%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F "Информация"). Этим SCTP похож на UDP. Таким образом, если отправитель отсылает серверу _сообщение_, состоящее из 100 байт за первый шаг, а за ним ещё 50 байт, то получатель за первый шаг получит именно первые 100 байт в первом сообщении, а только затем 50 байт на второй операции чтения из [сокета](https://ru.wikipedia.org/wiki/%D0%A1%D0%BE%D0%BA%D0%B5%D1%82_(%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%BD%D1%8B%D0%B9_%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81) "Сокет (программный интерфейс)").

[![](https://upload.wikimedia.org/wikipedia/commons/c/c4/%D0%9C%D0%BD%D0%BE%D0%B3%D0%BE%D0%BF%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%B2%D0%B0%D1%8F_%D0%BF%D0%B5%D1%80%D0%B5%D0%B4%D0%B0%D1%87%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85.jpg)](https://commons.wikimedia.org/wiki/File:%D0%9C%D0%BD%D0%BE%D0%B3%D0%BE%D0%BF%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%B2%D0%B0%D1%8F_%D0%BF%D0%B5%D1%80%D0%B5%D0%B4%D0%B0%D1%87%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85.jpg?uselang=ru)

Термин «многопоточность» (англ. _multi-streaming_) обозначает способность SCTP параллельно передавать по нескольким независимым потокам _сообщений_. Например, мы передаём несколько [фотографий](https://ru.wikipedia.org/wiki/%D0%A4%D0%BE%D1%82%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%8F "Фотография") через [HTTP](https://ru.wikipedia.org/wiki/HTTP "HTTP")-[приложение](https://ru.wikipedia.org/wiki/%D0%92%D0%B5%D0%B1-%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5 "Веб-приложение") (например, [браузер](https://ru.wikipedia.org/wiki/%D0%91%D1%80%D0%B0%D1%83%D0%B7%D0%B5%D1%80 "Браузер")). Можно использовать для этого связку из нескольких [TCP](https://ru.wikipedia.org/wiki/TCP "TCP")-соединений, однако также допустима _SCTP-ассоциация_ (англ. _SCTP-association_), управляющая несколькими [потоками](https://ru.wikipedia.org/wiki/%D0%9F%D0%BE%D1%82%D0%BE%D0%BA_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85 "Поток данных") сообщений для этой цели. Потоки являются однонаправленными, то есть передают информацию только в одном направлении (картинка выше является неточной).

TCP достигает правильного порядка байт в потоке, абстрактно назначая порядковый номер каждой отосланной единице, а упорядочивая принятые байты, используя назначенные порядковые номера, по мере их прибывания. С другой стороны, SCTP присваивает различные порядковые номера сообщениям, посылаемым в конкретном _[потоке](https://ru.wikipedia.org/wiki/%D0%9F%D0%BE%D1%82%D0%BE%D0%BA_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85 "Поток данных")_. Это разрешает независимое упорядочивание сообщений по разным потокам. Так или иначе, [многопоточность](https://ru.wikipedia.org/wiki/%D0%9C%D0%BD%D0%BE%D0%B3%D0%BE%D0%BF%D0%BE%D1%82%D0%BE%D1%87%D0%BD%D0%BE%D1%81%D1%82%D1%8C "Многопоточность") является опцией в SCTP. В зависимости от желаний пользовательского приложения сообщения могут быть обработаны не в порядке их отправления, а в порядке их поступления.

## Достоинства

Достоинства использования SCTP включают в себя:

- Использование множественных интерфейсов (англ _Multihoming_)  
    Допустим, у нас есть два [хоста](https://ru.wikipedia.org/wiki/%D0%A5%D0%BE%D1%81%D1%82 "Хост"). И хотя бы один из них имеет несколько сетевых интерфейсов и, соответственно, несколько IP-адресов. В TCP понятие «соединение» означает обмен данными между двумя точками, в то время как в SCTP имеет место концепция «ассоциации» (англ. _association_), обозначающая всё происходящее между двумя узлами

[![](https://upload.wikimedia.org/wikipedia/ru/thumb/7/71/SCTP.multi-homing.svg/524px-SCTP.multi-homing.svg.png)](https://ru.wikipedia.org/wiki/%D0%A4%D0%B0%D0%B9%D0%BB:SCTP.multi-homing.svg)

- Многопоточность  
    Данные приходят в точку по независимым потокам. Это позволяет устранить феномен [en:Head-of-line blocking](https://en.wikipedia.org/wiki/Head-of-line_blocking "en:Head-of-line blocking"), которым так страдает [TCP](https://ru.wikipedia.org/wiki/TCP "TCP")
- Поиск пути с мониторингом  
    Протоколом выбирается _первичный_ маршрут передачи данных, а также производится проверка и мониторинг связности пути.
- Механизмы проверки подлинности  
    Защита адресата от flood-атак (технология 4-way handshake), и уведомление о потерянных пакетах и нарушенных цепочках.
- Улучшенная система контроля ошибок, подходящая для [jumbo-пакетов](https://ru.wikipedia.org/wiki/Jumbo-%D0%BA%D0%B0%D0%B4%D1%80 "Jumbo-кадр") в [Ethernet](https://ru.wikipedia.org/wiki/Ethernet "Ethernet").

Часть достоинств вытекает из того факта, что изначально разработчики SCTP проектировали протокол под нужды передачи телефонии ([SS7](https://ru.wikipedia.org/wiki/SS7 "SS7")) по протоколу [IP](https://ru.wikipedia.org/wiki/IP "IP").

## Недостатки

- Бóльшая занимаемая полоса, то есть относительный объём служебного трафика больше, чем при использовании TCP/UDP.

## Безопасность

SCTP был разработан с некоторыми функциями, позволяющими повысить безопасность, такими как «4-кратное рукопожатие» (по сравнению с «трёхкратным рукопожатием» в TCP), чтобы предотвратить [SYN-flood](https://ru.wikipedia.org/wiki/SYN-flood "SYN-flood") атаки, и больших [Cookie](https://ru.wikipedia.org/wiki/Magic_cookie "Magic cookie") для проверки подлинности ассоциации.

Надёжность была одним из ключевых аспектов разработки безопасности протокола SCTP. Multi-homing позволяет ассоциации оставаться открытой, даже если некоторые используемые маршруты и интерфейсы стали недоступны. Это имеет особое значение для [SIGTRAN](https://ru.wikipedia.org/wiki/SIGTRAN "SIGTRAN"), который используя SCTP, передаёт сообщения и сервисы протоколов [ОКС-7](https://ru.wikipedia.org/wiki/%D0%9E%D0%9A%D0%A1-7 "ОКС-7")поверх IP сети, что требует сильной устойчивости во время отключений линков для поддержания телекоммуникационных услуг, даже при серьёзных аномалиях в сети.

Шифрование не является частью оригинального дизайна SCTP.

В некоторых случаях SCTP является хорошим кандидатом для [проверки на прочность стэка TCP/IP](https://ru.wikipedia.org/w/index.php?title=%D0%A6%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%BE%D0%B9_%D0%BE%D1%82%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%BE%D0%BA_%D1%81%D1%82%D1%8D%D0%BA%D0%B0_TCP/IP&action=edit&redlink=1 "Цифровой отпечаток стэка TCP/IP (страница отсутствует)")[[англ.]](https://en.wikipedia.org/wiki/TCP/IP_stack_fingerprinting "en:TCP/IP stack fingerprinting"). Причиной для этого является тот факт, что некоторые операционные системы распространяются с поддержкой протокола SCTP, но ввиду его слабой известности (по сравнению с TCP или UDP), администраторы иногда забывают настроить в [брандмауэре](https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D0%B6%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD "Межсетевой экран") обнаружения вторжений, что даёт возможности для сканирования трафика.