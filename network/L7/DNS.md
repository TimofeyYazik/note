**DNS** ([англ.](https://ru.wikipedia.org/wiki/%D0%90%D0%BD%D0%B3%D0%BB%D0%B8%D0%B9%D1%81%D0%BA%D0%B8%D0%B9_%D1%8F%D0%B7%D1%8B%D0%BA "Английский язык") Domain Name System «система доменных имён») — компьютерная [распределённая система](https://ru.wikipedia.org/wiki/%D0%A0%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D1%91%D0%BD%D0%BD%D0%B0%D1%8F_%D0%B1%D0%B0%D0%B7%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85 "Распределённая база данных") для получения информации о [доменах](https://ru.wikipedia.org/wiki/%D0%94%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D0%BE%D0%B5_%D0%B8%D0%BC%D1%8F "Доменное имя"). Чаще всего используется для получения [IP-адреса](https://ru.wikipedia.org/wiki/IP-%D0%B0%D0%B4%D1%80%D0%B5%D1%81 "IP-адрес") по имени [хоста](https://ru.wikipedia.org/wiki/%D0%A5%D0%BE%D1%81%D1%82 "Хост") (компьютера или устройства), получения информации о маршрутизации почты и/или обслуживающих узлах для протоколов в домене ([SRV-запись](https://ru.wikipedia.org/wiki/SRV-%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D1%8C "SRV-запись")).

[Распределённая база данных](https://ru.wikipedia.org/wiki/%D0%A0%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D1%91%D0%BD%D0%BD%D1%8B%D0%B5_%D0%B1%D0%B0%D0%B7%D1%8B_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85 "Распределённые базы данных") DNS поддерживается с помощью иерархии [DNS-серверов](https://ru.wikipedia.org/wiki/DNS-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80 "DNS-сервер"), взаимодействующих по определённому [протоколу](https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB_%D0%BF%D0%B5%D1%80%D0%B5%D0%B4%D0%B0%D1%87%D0%B8_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85 "Протокол передачи данных").

Основой DNS является представление об иерархической структуре [имени](https://ru.wikipedia.org/wiki/%D0%94%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D0%BE%D0%B5_%D0%B8%D0%BC%D1%8F "Доменное имя") и _зонах_. Каждый сервер, отвечающий за имя, может _передать_ ответственность за дальнейшую часть домена другому серверу (с административной точки зрения — другой организации или человеку), что позволяет возложить ответственность за актуальность информации на серверы различных организаций (людей), отвечающих только за «свою» часть доменного имени.

Начиная с 2010 года в систему DNS внедряются средства проверки целостности передаваемых данных, называемые _DNS Security Extensions_ ([DNSSEC](https://ru.wikipedia.org/wiki/DNSSEC "DNSSEC")). Передаваемые данные не шифруются, но их достоверность проверяется криптографическими способами. Внедряемый стандарт [DANE](https://ru.wikipedia.org/wiki/DANE "DANE") обеспечивает передачу средствами DNS достоверной криптографической информации ([сертификатов](https://ru.wikipedia.org/wiki/%D0%A1%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82_%D0%BE%D1%82%D0%BA%D1%80%D1%8B%D1%82%D0%BE%D0%B3%D0%BE_%D0%BA%D0%BB%D1%8E%D1%87%D0%B0 "Сертификат открытого ключа")), используемых для установления безопасных и защищённых соединений [транспортного](https://ru.wikipedia.org/wiki/%D0%A2%D1%80%D0%B0%D0%BD%D1%81%D0%BF%D0%BE%D1%80%D1%82%D0%BD%D1%8B%D0%B9_%D1%83%D1%80%D0%BE%D0%B2%D0%B5%D0%BD%D1%8C "Транспортный уровень") и [прикладного](https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB%D1%8B_%D0%BF%D1%80%D0%B8%D0%BA%D0%BB%D0%B0%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE_%D1%83%D1%80%D0%BE%D0%B2%D0%BD%D1%8F "Протоколы прикладного уровня") уровней.

DNS обладает следующими характеристиками:

- _Распределённость администрирования_. Ответственность за разные части иерархической структуры несут разные люди или организации.
- _Распределённость хранения информации_. Каждый узел сети в обязательном порядке должен хранить только те данные, которые входят в его _зону ответственности_, и (возможно) адреса _корневых DNS-серверов_.
- _[Кэширование](https://ru.wikipedia.org/wiki/%D0%9A%D1%8D%D1%88 "Кэш") информации_. Узел _может_ хранить некоторое количество данных не из своей зоны ответственности для уменьшения нагрузки на сеть.
- _Иерархическая структура_, в которой все узлы объединены в [дерево](https://ru.wikipedia.org/wiki/%D0%94%D0%B5%D1%80%D0%B5%D0%B2%D0%BE_(%D1%81%D1%82%D1%80%D1%83%D0%BA%D1%82%D1%83%D1%80%D0%B0_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85) "Дерево (структура данных)"), и каждый узел может или самостоятельно определять работу нижестоящих узлов, или _делегировать_(передавать) их другим узлам.
- _Резервирование_. За хранение и обслуживание своих узлов (зон) отвечают (обычно) несколько серверов, разделённые как физически, так и логически, что обеспечивает сохранность данных и продолжение работы даже в случае сбоя одного из узлов.

Ключевыми понятиями DNS являются:
- **[Доме́н](https://ru.wikipedia.org/wiki/%D0%94%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D0%BE%D0%B5_%D0%B8%D0%BC%D1%8F "Доменное имя")** ([англ.](https://ru.wikipedia.org/wiki/%D0%90%D0%BD%D0%B3%D0%BB%D0%B8%D0%B9%D1%81%D0%BA%D0%B8%D0%B9_%D1%8F%D0%B7%D1%8B%D0%BA "Английский язык") domain «область») — узел в дереве имён, вместе со всеми подчинёнными ему узлами (если таковые имеются), то есть именованная _ветвь_ или _поддерево_ в дереве имён. Структура доменного имени отражает порядок следования узлов в иерархии; доменное имя читается слева направо от младших доменов к доменам высшего уровня (в порядке повышения значимости): вверху находится [корневой домен](https://ru.wikipedia.org/wiki/%D0%9A%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D0%BE%D0%B9_%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD "Корневой домен") (имеющий идентификатор «`.`»(точка)), ниже идут домены первого уровня ([доменные зоны](https://ru.wikipedia.org/wiki/%D0%94%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D0%B0%D1%8F_%D0%B7%D0%BE%D0%BD%D0%B0 "Доменная зона")), затем — домены второго уровня, третьего и т. д. (например, для адреса `ru.wikipedia.org.` домен первого уровня — `org`, второго — `wikipedia`, третьего — `ru`). DNS позволяет не указывать точку корневого домена.
- **[Поддомен](https://ru.wikipedia.org/wiki/%D0%9F%D0%BE%D0%B4%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD "Поддомен")** ([англ.](https://ru.wikipedia.org/wiki/%D0%90%D0%BD%D0%B3%D0%BB%D0%B8%D0%B9%D1%81%D0%BA%D0%B8%D0%B9_%D1%8F%D0%B7%D1%8B%D0%BA "Английский язык") subdomain) — подчинённый домен (например, `wikipedia.org` — поддомен домена `org`, а `ru.wikipedia.org` — домена `wikipedia.org`). Теоретически такое деление может достигать глубины 127 уровней, а каждая метка может содержать до 63 символов, пока общая длина вместе с точками не достигнет 254 символов. Но на практике [регистраторы доменных имён](https://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D0%B3%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80_%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D1%85_%D0%B8%D0%BC%D1%91%D0%BD "Регистратор доменных имён") используют более строгие ограничения. Например, если у вас есть домен вида `mydomain.ru`, вы можете создать для него различные поддомены вида `mysite1.mydomain.ru`, `mysite2.mydomain.ru` и т. д.
- **[Ресурсная запись](https://ru.wikipedia.org/wiki/DNS#%D0%97%D0%B0%D0%BF%D0%B8%D1%81%D0%B8_DNS)** — единица хранения и передачи информации в DNS. Каждая ресурсная запись имеет _имя_ (то есть привязана к определённому **доменному имени**, узлу в дереве имён), _тип_ и _поле данных_, формат и содержание которого зависит от _типа_.
- **Зона** — часть дерева доменных имён (включая **ресурсные записи**), размещаемая как единое целое на некотором сервере доменных имён (**DNS-сервере**, см. ниже), а чаще — одновременно на нескольких серверах (см. ниже). Целью выделения части дерева в отдельную зону является передача **ответственности** (см. ниже) за соответствующий **домен**другому лицу или организации. Это называется **делегированием** (см. ниже). Как связная часть дерева, **зона** внутри тоже представляет собой дерево. Если рассматривать пространство имён DNS как структуру из зон, а не отдельных узлов/имён, тоже получается дерево; оправданно говорить о родительских и дочерних зонах, о старших и подчинённых. На практике большинство зон 0-го и 1-го уровня ('.', ru, com, …) состоят из единственного узла, которому непосредственно подчиняются дочерние зоны. В больших корпоративных доменах (2-го и более уровней) иногда встречается образование дополнительных подчинённых уровней без выделения их в дочерние зоны.
- **Делегирование** — операция передачи **ответственности** за часть дерева доменных имён другому лицу или организации. За счёт делегирования в DNS обеспечивается распределённость администрирования и хранения. Технически **делегирование** выражается в выделении этой части дерева в отдельную **зону**, и размещении этой **зоны** на **DNS-сервере** (см. ниже), управляемом этим лицом или организацией. При этом в родительскую зону включаются «[склеивающие](https://ru.wikipedia.org/wiki/Glue "Glue")» **ресурсные записи** (NS и А), содержащие указатели на **DNS-сервера** дочерней зоны, а вся остальная информация, относящаяся к дочерней зоне, хранится уже на **DNS-серверах** дочерней зоны.
- **[DNS-сервер](https://ru.wikipedia.org/wiki/DNS-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80 "DNS-сервер")** — специализированное ПО для обслуживания DNS, а также компьютер, на котором это ПО выполняется. DNS-сервер может быть ответственным за некоторые зоны и/или может перенаправлять запросы вышестоящим серверам.
- **[DNS-клиент](https://ru.wikipedia.org/wiki/DNS-%D0%BA%D0%BB%D0%B8%D0%B5%D0%BD%D1%82 "DNS-клиент")** — специализированная библиотека (или программа) для работы с DNS. В ряде случаев DNS-сервер выступает в роли DNS-клиента.
- **Авторитетность** ([англ.](https://ru.wikipedia.org/wiki/%D0%90%D0%BD%D0%B3%D0%BB%D0%B8%D0%B9%D1%81%D0%BA%D0%B8%D0%B9_%D1%8F%D0%B7%D1%8B%D0%BA "Английский язык") authoritative) — признак размещения зоны на DNS-сервере. Ответы DNS-сервера могут быть двух типов: _авторитетные_ (когда сервер заявляет, что сам отвечает за зону) и _неавторитетные_ ([англ.](https://ru.wikipedia.org/wiki/%D0%90%D0%BD%D0%B3%D0%BB%D0%B8%D0%B9%D1%81%D0%BA%D0%B8%D0%B9_%D1%8F%D0%B7%D1%8B%D0%BA "Английский язык") Non-authoritative), когда сервер обрабатывает запрос, и возвращает ответ других серверов. В некоторых случаях вместо передачи запроса дальше DNS-сервер может вернуть уже известное ему (по запросам ранее) значение (режим кеширования).
- **DNS-запрос** ([англ.](https://ru.wikipedia.org/wiki/%D0%90%D0%BD%D0%B3%D0%BB%D0%B8%D0%B9%D1%81%D0%BA%D0%B8%D0%B9_%D1%8F%D0%B7%D1%8B%D0%BA "Английский язык") DNS query) — запрос от клиента (или сервера) серверу. Запрос может быть _рекурсивным_ или _нерекурсивным_ (см. [Рекурсия](https://ru.wikipedia.org/wiki/DNS#%D0%A0%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D1%8F)).

Система DNS содержит иерархию **DNS-серверов**, соответствующую иерархии **зон**. Каждая **зона** поддерживается как минимум одним _авторитетным сервером DNS_ (от [англ.](https://ru.wikipedia.org/wiki/%D0%90%D0%BD%D0%B3%D0%BB%D0%B8%D0%B9%D1%81%D0%BA%D0%B8%D0%B9_%D1%8F%D0%B7%D1%8B%D0%BA "Английский язык") authoritative — авторитетный), на котором расположена информация о домене.

Имя и IP-адрес не [тождественны](https://ru.wikipedia.org/wiki/%D0%A2%D0%BE%D0%B6%D0%B4%D0%B5%D1%81%D1%82%D0%B2%D0%BE_(%D1%84%D0%B8%D0%BB%D0%BE%D1%81%D0%BE%D1%84%D0%B8%D1%8F) "Тождество (философия)") — один IP-адрес может иметь множество имён, что позволяет поддерживать на одном компьютере множество [веб-сайтов](https://ru.wikipedia.org/wiki/%D0%92%D0%B5%D0%B1-%D1%81%D0%B0%D0%B9%D1%82 "Веб-сайт") (это называется [виртуальный хостинг](https://ru.wikipedia.org/wiki/%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%85%D0%BE%D1%81%D1%82%D0%B8%D0%BD%D0%B3 "Виртуальный хостинг")). Обратное тоже справедливо — одному имени может быть сопоставлено множество IP-адресов: это позволяет создавать [балансировку нагрузки](https://ru.wikipedia.org/wiki/%D0%91%D0%B0%D0%BB%D0%B0%D0%BD%D1%81%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BD%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B8 "Балансировка нагрузки").

Для повышения устойчивости системы используется множество серверов, содержащих идентичную информацию, а в протоколе есть средства, позволяющие поддерживать синхронность информации, расположенной на разных серверах. Существует 13 [корневых серверов](https://ru.wikipedia.org/wiki/%D0%9A%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D1%8B%D0%B5_%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D1%8B_DNS "Корневые серверы DNS"), их адреса практически не изменяются.[[3]](https://ru.wikipedia.org/wiki/DNS#cite_note-3)

Протокол DNS использует для работы [TCP](https://ru.wikipedia.org/wiki/TCP "TCP")- или [UDP](https://ru.wikipedia.org/wiki/UDP "UDP")-[порт](https://ru.wikipedia.org/wiki/%D0%9F%D0%BE%D1%80%D1%82_(%D0%BA%D0%BE%D0%BC%D0%BF%D1%8C%D1%8E%D1%82%D0%B5%D1%80%D0%BD%D1%8B%D0%B5_%D1%81%D0%B5%D1%82%D0%B8) "Порт (компьютерные сети)") 53 для ответов на запросы. Традиционно запросы и ответы отправляются в виде одной UDP-[датаграммы](https://ru.wikipedia.org/wiki/%D0%94%D0%B0%D1%82%D0%B0%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B0 "Датаграмма"). TCP используется, когда размер данных ответа превышает 512 байт, и для [AXFR](https://ru.wikipedia.org/wiki/%D0%9F%D0%B5%D1%80%D0%B5%D0%B4%D0%B0%D1%87%D0%B0_%D0%B7%D0%BE%D0%BD%D1%8B_DNS "Передача зоны DNS")-запросов.

### Рекурсия

Термином **рекурсия** в DNS обозначают алгоритм поведения **DNS-сервера**: «выполнить от имени клиента полный поиск нужной информации во всей системе DNS, при необходимости обращаясь к другим **DNS-серверам»**.

**DNS-запрос** может быть _рекурсивным_ — требующим полного поиска, — и _нерекурсивным_ (или _итеративным_) — не требующим полного поиска.

Аналогично — **DNS-сервер** может быть _рекурсивным_ (умеющим выполнять полный поиск) и _нерекурсивным_ (не умеющим выполнять полный поиск). Некоторые программы DNS-серверов, например, [BIND](https://ru.wikipedia.org/wiki/BIND "BIND"), можно сконфигурировать так, чтобы запросы одних клиентов выполнялись _рекурсивно_, а запросы других — _нерекурсивно_.

При ответе на _нерекурсивный_ запрос, а также при неумении или запрете выполнять _рекурсивные_ запросы, DNS-сервер либо возвращает данные о зоне, за которую он **ответственен**, либо возвращает ошибку. Настройки нерекурсивного сервера, когда при ответе выдаются адреса серверов, которые обладают большим объёмом информации о запрошенной зоне, чем отвечающий сервер (чаще всего — адреса корневых серверов), являются некорректными, и такой сервер может быть использован для организации [DoS-атак](https://ru.wikipedia.org/wiki/DoS-%D0%B0%D1%82%D0%B0%D0%BA%D0%B0 "DoS-атака").

В случае _рекурсивного_ запроса **DNS-сервер** опрашивает серверы (в порядке убывания уровня зон в имени), пока не найдёт ответ или не обнаружит, что домен не существует (на практике поиск начинается с наиболее близких к искомому DNS-серверов, если информация о них есть в кэше и не устарела, сервер может не запрашивать другие DNS-серверы).

Рассмотрим на примере работу всей системы.

Предположим, мы набрали в [браузере](https://ru.wikipedia.org/wiki/%D0%91%D1%80%D0%B0%D1%83%D0%B7%D0%B5%D1%80 "Браузер") адрес `ru.wikipedia.org`. Браузер ищет соответствие этого адреса IP-адресу в файле _hosts_. Если файл не содержит соответствия, то далее браузер спрашивает у сервера DNS: «какой IP-адрес у `ru.wikipedia.org`»? Однако сервер DNS может ничего не знать не только о запрошенном имени, но и даже обо всём домене `wikipedia.org`. В этом случае сервер обращается к _[корневому серверу](https://ru.wikipedia.org/wiki/%D0%9A%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D1%8B%D0%B5_%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D1%8B_DNS "Корневые серверы DNS")_ — например, 198.41.0.4. Этот сервер сообщает — «У меня нет информации о данном адресе, но я знаю, что 204.74.112.1 является ответственным за зону `org`.» Тогда сервер DNS направляет свой запрос к 204.74.112.1, но тот отвечает «У меня нет информации о данном сервере, но я знаю, что 207.142.131.234 является ответственным за зону `wikipedia.org`.» Наконец, тот же запрос отправляется к третьему DNS-серверу и получает ответ — IP-адрес, который и передаётся клиенту — браузеру.

В данном случае при разрешении имени, то есть в процессе поиска IP по имени:

- браузер отправил известному ему DNS-серверу _рекурсивный_ запрос — в ответ на такой тип запроса сервер обязан вернуть «готовый результат», то есть IP-адрес, либо пустой ответ и код ошибки NXDOMAIN;
- DNS-сервер, получивший запрос от браузера, последовательно отправлял _нерекурсивные_ запросы, на которые получал от других DNS-серверов ответы, пока не получил ответ от сервера, ответственного за запрошенную зону;
- остальные упоминавшиеся DNS-серверы обрабатывали запросы _нерекурсивно_ (и, скорее всего, не стали бы обрабатывать запросы рекурсивно, даже если бы такое требование стояло в запросе).

Иногда допускается, чтобы запрошенный сервер передавал _рекурсивный_ запрос «вышестоящему» DNS-серверу и дожидался готового ответа.

При _рекурсивной_ обработке запросов все ответы проходят через DNS-сервер, и он получает возможность _[кэшировать](https://ru.wikipedia.org/wiki/%D0%9A%D1%8D%D1%88 "Кэш")_ их. Повторный запрос на те же имена обычно не идёт дальше _кэша_ сервера, обращения к другим серверам не происходит вообще. Допустимое время хранения ответов в _кэше_ приходит вместе с ответами (поле _TTL_ **[ресурсной записи](https://ru.wikipedia.org/wiki/DNS#%D0%97%D0%B0%D0%BF%D0%B8%D1%81%D0%B8_DNS)**).

Рекурсивные запросы требуют больше ресурсов от сервера (и создают больше трафика), так что обычно принимаются от «известных» владельцу сервера узлов (например, провайдер предоставляет возможность делать рекурсивные запросы только своим клиентам, в корпоративной сети рекурсивные запросы принимаются только из локального сегмента). Нерекурсивные запросы обычно принимаются ото всех узлов сети (и содержательный ответ даётся только на запросы о зоне, которая размещена на узле, на DNS-запрос о других зонах обычно возвращаются адреса других серверов).